#!/usr/bin/env php
<?php

/**
 * PHAPI Runner - Wrapper that ensures Swoole is loaded
 * 
 * Usage:
 *   ./bin/phapi-run app.php
 *   php bin/phapi-run app.php
 */

if (php_sapi_name() !== 'cli') {
    exit('This script can only be run from command line.');
}

require __DIR__ . '/../vendor/autoload.php';

if (!extension_loaded('swoole')) {
    echo "Error: Swoole extension is not loaded.\n";
    echo "Please install the native Swoole PHP extension.\n";
    exit(1);
}

// Swoole is loaded, run the script
$script = $argv[1] ?? 'app.php';
if (!file_exists($script)) {
    echo "Error: Script '$script' not found.\n";
    exit(1);
}

require $script;
